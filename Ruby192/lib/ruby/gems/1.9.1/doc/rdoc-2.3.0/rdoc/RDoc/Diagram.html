<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: RDoc::Diagram</title>

	<link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

	<script src="../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../lib/rdoc/diagram_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/rdoc/diagram.rb">lib/rdoc/diagram.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link">Object</p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-new">::new</a></li>
					
					<li><a href="#method-i-add_classes">#add_classes</a></li>
					
					<li><a href="#method-i-convert_to_png">#convert_to_png</a></li>
					
					<li><a href="#method-i-draw">#draw</a></li>
					
					<li><a href="#method-i-draw_module">#draw_module</a></li>
					
					<li><a href="#method-i-find_full_name">#find_full_name</a></li>
					
					<li><a href="#method-i-find_names">#find_names</a></li>
					
					<li><a href="#method-i-wrap_in_image_map">#wrap_in_image_map</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="../History_txt.html">History.txt</a></li>
				
					<li class="file"><a href="../Manifest_txt.html">Manifest.txt</a></li>
				
					<li class="file"><a href="../README_txt.html">README.txt</a></li>
				
					<li class="file"><a href="../RI_txt.html">RI.txt</a></li>
				
					<li class="file"><a href="../test/test_ja_txt.html">test.ja.txt</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../RDoc.html">RDoc</a></li>
				
					<li><a href="../RDoc/Alias.html">RDoc::Alias</a></li>
				
					<li><a href="../RDoc/AnonClass.html">RDoc::AnonClass</a></li>
				
					<li><a href="../RDoc/AnyMethod.html">RDoc::AnyMethod</a></li>
				
					<li><a href="../RDoc/Attr.html">RDoc::Attr</a></li>
				
					<li><a href="../RDoc/Cache.html">RDoc::Cache</a></li>
				
					<li><a href="../RDoc/ClassModule.html">RDoc::ClassModule</a></li>
				
					<li><a href="../RDoc/CodeObject.html">RDoc::CodeObject</a></li>
				
					<li><a href="../RDoc/Constant.html">RDoc::Constant</a></li>
				
					<li><a href="../RDoc/Context.html">RDoc::Context</a></li>
				
					<li><a href="../RDoc/Context/Section.html">RDoc::Context::Section</a></li>
				
					<li><a href="../RDoc/DOT.html">RDoc::DOT</a></li>
				
					<li><a href="../RDoc/DOT/Digraph.html">RDoc::DOT::Digraph</a></li>
				
					<li><a href="../RDoc/DOT/Edge.html">RDoc::DOT::Edge</a></li>
				
					<li><a href="../RDoc/DOT/Element.html">RDoc::DOT::Element</a></li>
				
					<li><a href="../RDoc/DOT/Node.html">RDoc::DOT::Node</a></li>
				
					<li><a href="../RDoc/DOT/Port.html">RDoc::DOT::Port</a></li>
				
					<li><a href="../RDoc/DOT/SimpleElement.html">RDoc::DOT::SimpleElement</a></li>
				
					<li><a href="../RDoc/DOT/Subgraph.html">RDoc::DOT::Subgraph</a></li>
				
					<li><a href="../RDoc/Diagram.html">RDoc::Diagram</a></li>
				
					<li><a href="../RDoc/Error.html">RDoc::Error</a></li>
				
					<li><a href="../RDoc/Generator.html">RDoc::Generator</a></li>
				
					<li><a href="../RDoc/Generator/AllReferences.html">RDoc::Generator::AllReferences</a></li>
				
					<li><a href="../RDoc/Generator/Class.html">RDoc::Generator::Class</a></li>
				
					<li><a href="../RDoc/Generator/Context.html">RDoc::Generator::Context</a></li>
				
					<li><a href="../RDoc/Generator/Darkfish.html">RDoc::Generator::Darkfish</a></li>
				
					<li><a href="../RDoc/Generator/File.html">RDoc::Generator::File</a></li>
				
					<li><a href="../RDoc/Generator/HTML.html">RDoc::Generator::HTML</a></li>
				
					<li><a href="../RDoc/Generator/HTML/Common.html">RDoc::Generator::HTML::Common</a></li>
				
					<li><a href="../RDoc/Generator/HTML/HTML.html">RDoc::Generator::HTML::HTML</a></li>
				
					<li><a href="../RDoc/Generator/HTMLInOne.html">RDoc::Generator::HTMLInOne</a></li>
				
					<li><a href="../RDoc/Generator/MarkUp.html">RDoc::Generator::MarkUp</a></li>
				
					<li><a href="../RDoc/Generator/Method.html">RDoc::Generator::Method</a></li>
				
					<li><a href="../RDoc/Generator/RI.html">RDoc::Generator::RI</a></li>
				
					<li><a href="../RDoc/Generator/XML.html">RDoc::Generator::XML</a></li>
				
					<li><a href="../RDoc/GhostMethod.html">RDoc::GhostMethod</a></li>
				
					<li><a href="../RDoc/Include.html">RDoc::Include</a></li>
				
					<li><a href="../RDoc/Markup.html">RDoc::Markup</a></li>
				
					<li><a href="../RDoc/Markup/AttrChanger.html">RDoc::Markup::AttrChanger</a></li>
				
					<li><a href="../RDoc/Markup/AttrSpan.html">RDoc::Markup::AttrSpan</a></li>
				
					<li><a href="../RDoc/Markup/Attribute.html">RDoc::Markup::Attribute</a></li>
				
					<li><a href="../RDoc/Markup/AttributeManager.html">RDoc::Markup::AttributeManager</a></li>
				
					<li><a href="../RDoc/Markup/BlankLine.html">RDoc::Markup::BlankLine</a></li>
				
					<li><a href="../RDoc/Markup/Flow.html">RDoc::Markup::Flow</a></li>
				
					<li><a href="../RDoc/Markup/Flow/LIST.html">RDoc::Markup::Flow::LIST</a></li>
				
					<li><a href="../RDoc/Markup/Formatter.html">RDoc::Markup::Formatter</a></li>
				
					<li><a href="../RDoc/Markup/Fragment.html">RDoc::Markup::Fragment</a></li>
				
					<li><a href="../RDoc/Markup/Heading.html">RDoc::Markup::Heading</a></li>
				
					<li><a href="../RDoc/Markup/Line.html">RDoc::Markup::Line</a></li>
				
					<li><a href="../RDoc/Markup/LineCollection.html">RDoc::Markup::LineCollection</a></li>
				
					<li><a href="../RDoc/Markup/Lines.html">RDoc::Markup::Lines</a></li>
				
					<li><a href="../RDoc/Markup/ListBase.html">RDoc::Markup::ListBase</a></li>
				
					<li><a href="../RDoc/Markup/ListEnd.html">RDoc::Markup::ListEnd</a></li>
				
					<li><a href="../RDoc/Markup/ListItem.html">RDoc::Markup::ListItem</a></li>
				
					<li><a href="../RDoc/Markup/ListStart.html">RDoc::Markup::ListStart</a></li>
				
					<li><a href="../RDoc/Markup/Paragraph.html">RDoc::Markup::Paragraph</a></li>
				
					<li><a href="../RDoc/Markup/PreProcess.html">RDoc::Markup::PreProcess</a></li>
				
					<li><a href="../RDoc/Markup/Rule.html">RDoc::Markup::Rule</a></li>
				
					<li><a href="../RDoc/Markup/Special.html">RDoc::Markup::Special</a></li>
				
					<li><a href="../RDoc/Markup/ToFlow.html">RDoc::Markup::ToFlow</a></li>
				
					<li><a href="../RDoc/Markup/ToHtml.html">RDoc::Markup::ToHtml</a></li>
				
					<li><a href="../RDoc/Markup/ToHtmlCrossref.html">RDoc::Markup::ToHtmlCrossref</a></li>
				
					<li><a href="../RDoc/Markup/ToLaTeX.html">RDoc::Markup::ToLaTeX</a></li>
				
					<li><a href="../RDoc/Markup/ToTest.html">RDoc::Markup::ToTest</a></li>
				
					<li><a href="../RDoc/Markup/ToTexInfo.html">RDoc::Markup::ToTexInfo</a></li>
				
					<li><a href="../RDoc/Markup/Verbatim.html">RDoc::Markup::Verbatim</a></li>
				
					<li><a href="../RDoc/MetaMethod.html">RDoc::MetaMethod</a></li>
				
					<li><a href="../RDoc/NormalClass.html">RDoc::NormalClass</a></li>
				
					<li><a href="../RDoc/NormalModule.html">RDoc::NormalModule</a></li>
				
					<li><a href="../RDoc/Options.html">RDoc::Options</a></li>
				
					<li><a href="../RDoc/Parser.html">RDoc::Parser</a></li>
				
					<li><a href="../RDoc/Parser/C.html">RDoc::Parser::C</a></li>
				
					<li><a href="../RDoc/Parser/F95.html">RDoc::Parser::F95</a></li>
				
					<li><a href="../RDoc/Parser/F95/Fortran95Definition.html">RDoc::Parser::F95::Fortran95Definition</a></li>
				
					<li><a href="../RDoc/Parser/F95/Token.html">RDoc::Parser::F95::Token</a></li>
				
					<li><a href="../RDoc/Parser/PerlPOD.html">RDoc::Parser::PerlPOD</a></li>
				
					<li><a href="../RDoc/Parser/Ruby.html">RDoc::Parser::Ruby</a></li>
				
					<li><a href="../RDoc/Parser/Simple.html">RDoc::Parser::Simple</a></li>
				
					<li><a href="../RDoc/RDoc.html">RDoc::RDoc</a></li>
				
					<li><a href="../RDoc/RI.html">RDoc::RI</a></li>
				
					<li><a href="../RDoc/RI/AliasName.html">RDoc::RI::AliasName</a></li>
				
					<li><a href="../RDoc/RI/AnsiFormatter.html">RDoc::RI::AnsiFormatter</a></li>
				
					<li><a href="../RDoc/RI/Attribute.html">RDoc::RI::Attribute</a></li>
				
					<li><a href="../RDoc/RI/AttributeFormatter.html">RDoc::RI::AttributeFormatter</a></li>
				
					<li><a href="../RDoc/RI/AttributeFormatter/AttributeString.html">RDoc::RI::AttributeFormatter::AttributeString</a></li>
				
					<li><a href="../RDoc/RI/Cache.html">RDoc::RI::Cache</a></li>
				
					<li><a href="../RDoc/RI/ClassDescription.html">RDoc::RI::ClassDescription</a></li>
				
					<li><a href="../RDoc/RI/ClassEntry.html">RDoc::RI::ClassEntry</a></li>
				
					<li><a href="../RDoc/RI/Constant.html">RDoc::RI::Constant</a></li>
				
					<li><a href="../RDoc/RI/DefaultDisplay.html">RDoc::RI::DefaultDisplay</a></li>
				
					<li><a href="../RDoc/RI/Description.html">RDoc::RI::Description</a></li>
				
					<li><a href="../RDoc/RI/Display.html">RDoc::RI::Display</a></li>
				
					<li><a href="../RDoc/RI/Driver.html">RDoc::RI::Driver</a></li>
				
					<li><a href="../RDoc/RI/Driver/Error.html">RDoc::RI::Driver::Error</a></li>
				
					<li><a href="../RDoc/RI/Driver/NotFoundError.html">RDoc::RI::Driver::NotFoundError</a></li>
				
					<li><a href="../RDoc/RI/Driver/OpenStructHash.html">RDoc::RI::Driver::OpenStructHash</a></li>
				
					<li><a href="../RDoc/RI/Error.html">RDoc::RI::Error</a></li>
				
					<li><a href="../RDoc/RI/Formatter.html">RDoc::RI::Formatter</a></li>
				
					<li><a href="../RDoc/RI/HtmlFormatter.html">RDoc::RI::HtmlFormatter</a></li>
				
					<li><a href="../RDoc/RI/IncludedModule.html">RDoc::RI::IncludedModule</a></li>
				
					<li><a href="../RDoc/RI/MethodDescription.html">RDoc::RI::MethodDescription</a></li>
				
					<li><a href="../RDoc/RI/MethodEntry.html">RDoc::RI::MethodEntry</a></li>
				
					<li><a href="../RDoc/RI/MethodSummary.html">RDoc::RI::MethodSummary</a></li>
				
					<li><a href="../RDoc/RI/ModuleDescription.html">RDoc::RI::ModuleDescription</a></li>
				
					<li><a href="../RDoc/RI/NameDescriptor.html">RDoc::RI::NameDescriptor</a></li>
				
					<li><a href="../RDoc/RI/NamedThing.html">RDoc::RI::NamedThing</a></li>
				
					<li><a href="../RDoc/RI/OverstrikeFormatter.html">RDoc::RI::OverstrikeFormatter</a></li>
				
					<li><a href="../RDoc/RI/Reader.html">RDoc::RI::Reader</a></li>
				
					<li><a href="../RDoc/RI/SimpleFormatter.html">RDoc::RI::SimpleFormatter</a></li>
				
					<li><a href="../RDoc/RI/TopLevelEntry.html">RDoc::RI::TopLevelEntry</a></li>
				
					<li><a href="../RDoc/RI/Writer.html">RDoc::RI::Writer</a></li>
				
					<li><a href="../RDoc/Require.html">RDoc::Require</a></li>
				
					<li><a href="../RDoc/RubyLex.html">RDoc::RubyLex</a></li>
				
					<li><a href="../RDoc/RubyLex/BufferedReader.html">RDoc::RubyLex::BufferedReader</a></li>
				
					<li><a href="../RDoc/RubyToken.html">RDoc::RubyToken</a></li>
				
					<li><a href="../RDoc/RubyToken/TkError.html">RDoc::RubyToken::TkError</a></li>
				
					<li><a href="../RDoc/RubyToken/TkId.html">RDoc::RubyToken::TkId</a></li>
				
					<li><a href="../RDoc/RubyToken/TkKW.html">RDoc::RubyToken::TkKW</a></li>
				
					<li><a href="../RDoc/RubyToken/TkNode.html">RDoc::RubyToken::TkNode</a></li>
				
					<li><a href="../RDoc/RubyToken/TkOPASGN.html">RDoc::RubyToken::TkOPASGN</a></li>
				
					<li><a href="../RDoc/RubyToken/TkOp.html">RDoc::RubyToken::TkOp</a></li>
				
					<li><a href="../RDoc/RubyToken/TkUnknownChar.html">RDoc::RubyToken::TkUnknownChar</a></li>
				
					<li><a href="../RDoc/RubyToken/TkVal.html">RDoc::RubyToken::TkVal</a></li>
				
					<li><a href="../RDoc/RubyToken/Token.html">RDoc::RubyToken::Token</a></li>
				
					<li><a href="../RDoc/SingleClass.html">RDoc::SingleClass</a></li>
				
					<li><a href="../RDoc/Stats.html">RDoc::Stats</a></li>
				
					<li><a href="../RDoc/Stats/Normal.html">RDoc::Stats::Normal</a></li>
				
					<li><a href="../RDoc/Stats/Quiet.html">RDoc::Stats::Quiet</a></li>
				
					<li><a href="../RDoc/Stats/Verbose.html">RDoc::Stats::Verbose</a></li>
				
					<li><a href="../RDoc/TokenStream.html">RDoc::TokenStream</a></li>
				
					<li><a href="../RDoc/TopLevel.html">RDoc::TopLevel</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">RDoc::Diagram</h1>

		<div id="description">
			<p>
Draw a set of diagrams representing the modules and classes in the system.
We draw one diagram for each file, and one for each toplevel class or
module. This means there will be overlap. However, it also means that
you&#8217;ll get better context for objects.
</p>
<p>
To use, simply
</p>
<pre>
  d = Diagram.new(info)   # pass in collection of top level infos
  d.draw
</pre>
<p>
The results will be written to the <tt>dot</tt> subdirectory. The process
also sets the <tt>diagram</tt> attribute in each object it graphs to the
name of the file containing the image. This can be used by output
generators to insert images.
</p>

		</div>

		<!-- Constants -->
		
		<div id="constants-list" class="section">
			<h3 class="section-header">Constants</h3>
			<dl>
			
				<dt><a name="FONT">FONT</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="DOT_PATH">DOT_PATH</a></dt>
				
				<dd class="description"></dd>
				
			
			</dl>
		</div>
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="new-method" class="method-detail ">
				<a name="method-c-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">(info, options)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Pass in the set of top level objects. The method also creates the
subdirectory to hold the images
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
    <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 37</span>
37:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">info</span>, <span class="ruby-identifier">options</span>)
38:       <span class="ruby-ivar">@info</span> = <span class="ruby-identifier">info</span>
39:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
40:       <span class="ruby-ivar">@counter</span> = <span class="ruby-value">0</span>
41:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-constant">DOT_PATH</span>)
42:       <span class="ruby-ivar">@diagram_cache</span> = {}
43:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="draw-method" class="method-detail ">
				<a name="method-i-draw"></a>

				<div class="method-heading">
				
					<span class="method-name">draw</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Draw the diagrams. We traverse the files, drawing a diagram for each. We
also traverse each top-level class and module in that file drawing a
diagram for these too.
</p>
					

					
					<div class="method-source-code"
						id="draw-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 50</span>
 50:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">draw</span>
 51:       <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>
 52:         <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;Diagrams: &quot;</span>
 53:         <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">flush</span>
 54:       <span class="ruby-keyword kw">end</span>
 55: 
 56:       <span class="ruby-ivar">@info</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">file_count</span><span class="ruby-operator">|</span>
 57:         <span class="ruby-ivar">@done_modules</span> = {}
 58:         <span class="ruby-ivar">@local_names</span> = <span class="ruby-identifier">find_names</span>(<span class="ruby-identifier">i</span>)
 59:         <span class="ruby-ivar">@global_names</span> = []
 60:         <span class="ruby-ivar">@global_graph</span> = <span class="ruby-identifier">graph</span> = <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Digraph</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'TopLevel'</span>,
 61:                                                  <span class="ruby-value str">'fontname'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">FONT</span>,
 62:                                                  <span class="ruby-value str">'fontsize'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'8'</span>,
 63:                                                  <span class="ruby-value str">'bgcolor'</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'lightcyan1'</span>,
 64:                                                  <span class="ruby-value str">'compound'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'true'</span>)
 65: 
 66:         <span class="ruby-comment cmt"># it's a little hack %) i'm too lazy to create a separate class</span>
 67:         <span class="ruby-comment cmt"># for default node</span>
 68:         <span class="ruby-identifier">graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'node'</span>,
 69:                                <span class="ruby-value str">'fontname'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">FONT</span>,
 70:                                <span class="ruby-value str">'color'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'black'</span>,
 71:                                <span class="ruby-value str">'fontsize'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">8</span>)
 72: 
 73:         <span class="ruby-identifier">i</span>.<span class="ruby-identifier">modules</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">mod</span><span class="ruby-operator">|</span>
 74:           <span class="ruby-identifier">draw_module</span>(<span class="ruby-identifier">mod</span>, <span class="ruby-identifier">graph</span>, <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">i</span>.<span class="ruby-identifier">file_relative_name</span>)
 75:         <span class="ruby-keyword kw">end</span>
 76:         <span class="ruby-identifier">add_classes</span>(<span class="ruby-identifier">i</span>, <span class="ruby-identifier">graph</span>, <span class="ruby-identifier">i</span>.<span class="ruby-identifier">file_relative_name</span>)
 77: 
 78:         <span class="ruby-identifier">i</span>.<span class="ruby-identifier">diagram</span> = <span class="ruby-identifier">convert_to_png</span>(<span class="ruby-node">&quot;f_#{file_count}&quot;</span>, <span class="ruby-identifier">graph</span>)
 79: 
 80:         <span class="ruby-comment cmt"># now go through and document each top level class and</span>
 81:         <span class="ruby-comment cmt"># module independently</span>
 82:         <span class="ruby-identifier">i</span>.<span class="ruby-identifier">modules</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">mod</span>, <span class="ruby-identifier">count</span><span class="ruby-operator">|</span>
 83:           <span class="ruby-ivar">@done_modules</span> = {}
 84:           <span class="ruby-ivar">@local_names</span> = <span class="ruby-identifier">find_names</span>(<span class="ruby-identifier">mod</span>)
 85:           <span class="ruby-ivar">@global_names</span> = []
 86: 
 87:           <span class="ruby-ivar">@global_graph</span> = <span class="ruby-identifier">graph</span> = <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Digraph</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'TopLevel'</span>,
 88:                                                    <span class="ruby-value str">'fontname'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">FONT</span>,
 89:                                                    <span class="ruby-value str">'fontsize'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'8'</span>,
 90:                                                    <span class="ruby-value str">'bgcolor'</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'lightcyan1'</span>,
 91:                                                    <span class="ruby-value str">'compound'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'true'</span>)
 92: 
 93:           <span class="ruby-identifier">graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'node'</span>,
 94:                                  <span class="ruby-value str">'fontname'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">FONT</span>,
 95:                                  <span class="ruby-value str">'color'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'black'</span>,
 96:                                  <span class="ruby-value str">'fontsize'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">8</span>)
 97:           <span class="ruby-identifier">draw_module</span>(<span class="ruby-identifier">mod</span>, <span class="ruby-identifier">graph</span>, <span class="ruby-keyword kw">true</span>)
 98:           <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">diagram</span> = <span class="ruby-identifier">convert_to_png</span>(<span class="ruby-node">&quot;m_#{file_count}_#{count}&quot;</span>,
 99:                                        <span class="ruby-identifier">graph</span>)
100:         <span class="ruby-keyword kw">end</span>
101:       <span class="ruby-keyword kw">end</span>
102:       <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>
103:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="private-instance-method-details" class="method-section section">
			<h3 class="section-header">Private Instance Methods</h3>

		
			<div id="add-classes-method" class="method-detail ">
				<a name="method-i-add_classes"></a>

				<div class="method-heading">
				
					<span class="method-name">add_classes</span><span
						class="method-args">(container, graph, file = nil )</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="add-classes-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 168</span>
168:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_classes</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">graph</span>, <span class="ruby-identifier">file</span> = <span class="ruby-keyword kw">nil</span> )
169: 
170:       <span class="ruby-identifier">use_fileboxes</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">fileboxes</span>
171: 
172:       <span class="ruby-identifier">files</span> = {}
173: 
174:       <span class="ruby-comment cmt"># create dummy node (needed if empty and for module includes)</span>
175:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">container</span>.<span class="ruby-identifier">full_name</span>
176:         <span class="ruby-identifier">graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{container.full_name.gsub( /:/,'_' )}&quot;</span>,
177:                                <span class="ruby-value str">'label'</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;&quot;</span>,
178:                                <span class="ruby-value str">'width'</span>  =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">container</span>.<span class="ruby-identifier">classes</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span>
179:                                             <span class="ruby-identifier">container</span>.<span class="ruby-identifier">modules</span>.<span class="ruby-identifier">empty?</span>) <span class="ruby-operator">?</span>
180:                                <span class="ruby-value str">'0.75'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'0.01'</span>,
181:                                <span class="ruby-value str">'height'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'0.01'</span>,
182:                                <span class="ruby-value str">'shape'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'plaintext'</span>)
183:       <span class="ruby-keyword kw">end</span>
184: 
185:       <span class="ruby-identifier">container</span>.<span class="ruby-identifier">classes</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cl</span>, <span class="ruby-identifier">cl_index</span><span class="ruby-operator">|</span>
186:         <span class="ruby-identifier">last_file</span> = <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">in_files</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">file_relative_name</span>
187: 
188:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">use_fileboxes</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">files</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">last_file</span>)
189:           <span class="ruby-ivar">@counter</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
190:           <span class="ruby-identifier">files</span>[<span class="ruby-identifier">last_file</span>] =
191:             <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Subgraph</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;cluster_#{@counter}&quot;</span>,
192:                                  <span class="ruby-value str">'label'</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{last_file}&quot;</span>,
193:                                  <span class="ruby-value str">'fontname'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">FONT</span>,
194:                                  <span class="ruby-value str">'color'</span>=<span class="ruby-operator">&gt;</span>
195:                                  <span class="ruby-identifier">last_file</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">file</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'red'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'black'</span>)
196:         <span class="ruby-keyword kw">end</span>
197: 
198:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'Object'</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">name</span>[<span class="ruby-value">0</span>,<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&lt;&lt;&quot;</span>
199: 
200:         <span class="ruby-identifier">url</span> = <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">http_url</span>(<span class="ruby-value str">&quot;classes&quot;</span>)
201: 
202:         <span class="ruby-identifier">label</span> = <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">dup</span>
203:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">use_fileboxes</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">in_files</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
204:           <span class="ruby-identifier">label</span> <span class="ruby-operator">&lt;&lt;</span>  <span class="ruby-value str">'\n['</span> <span class="ruby-operator">+</span>
205:                         <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">in_files</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
206:                              <span class="ruby-identifier">i</span>.<span class="ruby-identifier">file_relative_name</span>
207:                         }.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">join</span>( <span class="ruby-value str">'\n'</span> ) <span class="ruby-operator">+</span>
208:                     <span class="ruby-value str">']'</span>
209:         <span class="ruby-keyword kw">end</span>
210: 
211:         <span class="ruby-identifier">attrs</span> = {
212:           <span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{cl.full_name.gsub( /:/, '_' )}&quot;</span>,
213:           <span class="ruby-value str">'fontcolor'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'black'</span>,
214:           <span class="ruby-value str">'style'</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">'filled'</span>,
215:           <span class="ruby-value str">'color'</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value str">'palegoldenrod'</span>,
216:           <span class="ruby-value str">'label'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">label</span>,
217:           <span class="ruby-value str">'shape'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'ellipse'</span>,
218:           <span class="ruby-value str">'URL'</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%{&quot;#{url}&quot;}</span>
219:         }
220: 
221:         <span class="ruby-identifier">c</span> = <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">attrs</span>)
222: 
223:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">use_fileboxes</span>
224:           <span class="ruby-identifier">files</span>[<span class="ruby-identifier">last_file</span>].<span class="ruby-identifier">push</span> <span class="ruby-identifier">c</span>
225:         <span class="ruby-keyword kw">else</span>
226:           <span class="ruby-identifier">graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
227:         <span class="ruby-keyword kw">end</span>
228:       <span class="ruby-keyword kw">end</span>
229: 
230:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">use_fileboxes</span>
231:         <span class="ruby-identifier">files</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
232:           <span class="ruby-identifier">graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">val</span>
233:         <span class="ruby-keyword kw">end</span>
234:       <span class="ruby-keyword kw">end</span>
235: 
236:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">container</span>.<span class="ruby-identifier">classes</span>.<span class="ruby-identifier">empty?</span>
237:         <span class="ruby-identifier">container</span>.<span class="ruby-identifier">classes</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cl</span>, <span class="ruby-identifier">cl_index</span><span class="ruby-operator">|</span>
238:           <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">includes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>
239:             <span class="ruby-identifier">m_full_name</span> = <span class="ruby-identifier">find_full_name</span>(<span class="ruby-identifier">m</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">cl</span>)
240:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@local_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">m_full_name</span>)
241:               <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'from'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name.gsub( /:/,'_' )}&quot;</span>,
242:                                              <span class="ruby-value str">'to'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{cl.full_name.gsub( /:/,'_' )}&quot;</span>,
243:                                              <span class="ruby-value str">'ltail'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;cluster_#{m_full_name.gsub( /:/,'_' )}&quot;</span>)
244:             <span class="ruby-keyword kw">else</span>
245:               <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@global_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">m_full_name</span>)
246:                 <span class="ruby-identifier">path</span> = <span class="ruby-identifier">m_full_name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;::&quot;</span>)
247:                 <span class="ruby-identifier">url</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'classes'</span>, *<span class="ruby-identifier">path</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;.html&quot;</span>
248:                 <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name.gsub( /:/,'_' )}&quot;</span>,
249:                                                <span class="ruby-value str">'shape'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'box'</span>,
250:                                                <span class="ruby-value str">'label'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name}&quot;</span>,
251:                                                <span class="ruby-value str">'URL'</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%{&quot;#{url}&quot;}</span>)
252:                 <span class="ruby-ivar">@global_names</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m_full_name</span>
253:               <span class="ruby-keyword kw">end</span>
254:               <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'from'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name.gsub( /:/,'_' )}&quot;</span>,
255:                                              <span class="ruby-value str">'to'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{cl.full_name.gsub( /:/, '_')}&quot;</span>)
256:             <span class="ruby-keyword kw">end</span>
257:           <span class="ruby-keyword kw">end</span>
258: 
259:           <span class="ruby-identifier">sclass</span> = <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">superclass</span>
260:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sclass</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">sclass</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'Object'</span>
261:           <span class="ruby-identifier">sclass_full_name</span> = <span class="ruby-identifier">find_full_name</span>(<span class="ruby-identifier">sclass</span>,<span class="ruby-identifier">cl</span>)
262:           <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@local_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">sclass_full_name</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@global_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">sclass_full_name</span>)
263:             <span class="ruby-identifier">path</span> = <span class="ruby-identifier">sclass_full_name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;::&quot;</span>)
264:             <span class="ruby-identifier">url</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'classes'</span>, *<span class="ruby-identifier">path</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;.html&quot;</span>
265:             <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{sclass_full_name.gsub( /:/, '_' )}&quot;</span>,
266:                                            <span class="ruby-value str">'label'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">sclass_full_name</span>,
267:                                            <span class="ruby-value str">'URL'</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%{&quot;#{url}&quot;}</span>)
268:             <span class="ruby-ivar">@global_names</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">sclass_full_name</span>
269:           <span class="ruby-keyword kw">end</span>
270:           <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'from'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{sclass_full_name.gsub( /:/,'_' )}&quot;</span>,
271:                                          <span class="ruby-value str">'to'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{cl.full_name.gsub( /:/, '_')}&quot;</span>)
272:         <span class="ruby-keyword kw">end</span>
273:       <span class="ruby-keyword kw">end</span>
274: 
275:       <span class="ruby-identifier">container</span>.<span class="ruby-identifier">modules</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">submod</span><span class="ruby-operator">|</span>
276:         <span class="ruby-identifier">draw_module</span>(<span class="ruby-identifier">submod</span>, <span class="ruby-identifier">graph</span>)
277:       <span class="ruby-keyword kw">end</span>
278: 
279:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="convert-to-png-method" class="method-detail ">
				<a name="method-i-convert_to_png"></a>

				<div class="method-heading">
				
					<span class="method-name">convert_to_png</span><span
						class="method-args">(file_base, graph)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="convert-to-png-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 281</span>
281:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">convert_to_png</span>(<span class="ruby-identifier">file_base</span>, <span class="ruby-identifier">graph</span>)
282:       <span class="ruby-identifier">str</span> = <span class="ruby-identifier">graph</span>.<span class="ruby-identifier">to_s</span>
283:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@diagram_cache</span>[<span class="ruby-identifier">str</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@diagram_cache</span>[<span class="ruby-identifier">str</span>]
284:       <span class="ruby-identifier">op_type</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">image_format</span>
285:       <span class="ruby-identifier">dotfile</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">DOT_PATH</span>, <span class="ruby-identifier">file_base</span>)
286:       <span class="ruby-identifier">src</span> = <span class="ruby-identifier">dotfile</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;.dot&quot;</span>
287:       <span class="ruby-identifier">dot</span> = <span class="ruby-identifier">dotfile</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;.&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">op_type</span>
288: 
289:       <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>
290:         <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;.&quot;</span>
291:         <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">flush</span>
292:       <span class="ruby-keyword kw">end</span>
293: 
294:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">src</span>, <span class="ruby-value str">'w+'</span> ) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
295:         <span class="ruby-identifier">f</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
296:       <span class="ruby-keyword kw">end</span>
297: 
298:       <span class="ruby-identifier">system</span> <span class="ruby-value str">&quot;dot&quot;</span>, <span class="ruby-node">&quot;-T#{op_type}&quot;</span>, <span class="ruby-identifier">src</span>, <span class="ruby-value str">&quot;-o&quot;</span>, <span class="ruby-identifier">dot</span>
299: 
300:       <span class="ruby-comment cmt"># Now construct the imagemap wrapper around</span>
301:       <span class="ruby-comment cmt"># that png</span>
302: 
303:       <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wrap_in_image_map</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">dot</span>)
304:       <span class="ruby-ivar">@diagram_cache</span>[<span class="ruby-identifier">str</span>] = <span class="ruby-identifier">ret</span>
305:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ret</span>
306:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="draw-module-method" class="method-detail ">
				<a name="method-i-draw_module"></a>

				<div class="method-heading">
				
					<span class="method-name">draw_module</span><span
						class="method-args">(mod, graph, toplevel = false, file = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="draw-module-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 125</span>
125:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">draw_module</span>(<span class="ruby-identifier">mod</span>, <span class="ruby-identifier">graph</span>, <span class="ruby-identifier">toplevel</span> = <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">file</span> = <span class="ruby-keyword kw">nil</span>)
126:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span>  <span class="ruby-ivar">@done_modules</span>[<span class="ruby-identifier">mod</span>.<span class="ruby-identifier">full_name</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">toplevel</span>
127: 
128:       <span class="ruby-ivar">@counter</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
129:       <span class="ruby-identifier">url</span> = <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">http_url</span>(<span class="ruby-value str">&quot;classes&quot;</span>)
130:       <span class="ruby-identifier">m</span> = <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Subgraph</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;cluster_#{mod.full_name.gsub( /:/,'_' )}&quot;</span>,
131:                             <span class="ruby-value str">'label'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">name</span>,
132:                             <span class="ruby-value str">'fontname'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">FONT</span>,
133:                             <span class="ruby-value str">'color'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'blue'</span>,
134:                             <span class="ruby-value str">'style'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'filled'</span>,
135:                             <span class="ruby-value str">'URL'</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%{&quot;#{url}&quot;}</span>,
136:                             <span class="ruby-value str">'fillcolor'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">toplevel</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'palegreen1'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'palegreen3'</span>)
137: 
138:       <span class="ruby-ivar">@done_modules</span>[<span class="ruby-identifier">mod</span>.<span class="ruby-identifier">full_name</span>] = <span class="ruby-identifier">m</span>
139:       <span class="ruby-identifier">add_classes</span>(<span class="ruby-identifier">mod</span>, <span class="ruby-identifier">m</span>, <span class="ruby-identifier">file</span>)
140:       <span class="ruby-identifier">graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m</span>
141: 
142:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">includes</span>.<span class="ruby-identifier">empty?</span>
143:         <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">includes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inc</span><span class="ruby-operator">|</span>
144:           <span class="ruby-identifier">m_full_name</span> = <span class="ruby-identifier">find_full_name</span>(<span class="ruby-identifier">inc</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">mod</span>)
145:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@local_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">m_full_name</span>)
146:             <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'from'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name.gsub( /:/,'_' )}&quot;</span>,
147:                                            <span class="ruby-value str">'to'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{mod.full_name.gsub( /:/,'_' )}&quot;</span>,
148:                                            <span class="ruby-value str">'ltail'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;cluster_#{m_full_name.gsub( /:/,'_' )}&quot;</span>,
149:                                            <span class="ruby-value str">'lhead'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;cluster_#{mod.full_name.gsub( /:/,'_' )}&quot;</span>)
150:           <span class="ruby-keyword kw">else</span>
151:             <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@global_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">m_full_name</span>)
152:               <span class="ruby-identifier">path</span> = <span class="ruby-identifier">m_full_name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;::&quot;</span>)
153:               <span class="ruby-identifier">url</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'classes'</span>, *<span class="ruby-identifier">path</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;.html&quot;</span>
154:               <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Node</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name.gsub( /:/,'_' )}&quot;</span>,
155:                                              <span class="ruby-value str">'shape'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'box'</span>,
156:                                              <span class="ruby-value str">'label'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name}&quot;</span>,
157:                                              <span class="ruby-value str">'URL'</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%{&quot;#{url}&quot;}</span>)
158:               <span class="ruby-ivar">@global_names</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m_full_name</span>
159:             <span class="ruby-keyword kw">end</span>
160:             <span class="ruby-ivar">@global_graph</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">DOT</span><span class="ruby-operator">::</span><span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'from'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{m_full_name.gsub( /:/,'_' )}&quot;</span>,
161:                                            <span class="ruby-value str">'to'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{mod.full_name.gsub( /:/,'_' )}&quot;</span>,
162:                                            <span class="ruby-value str">'lhead'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;cluster_#{mod.full_name.gsub( /:/,'_' )}&quot;</span>)
163:           <span class="ruby-keyword kw">end</span>
164:         <span class="ruby-keyword kw">end</span>
165:       <span class="ruby-keyword kw">end</span>
166:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="find-full-name-method" class="method-detail ">
				<a name="method-i-find_full_name"></a>

				<div class="method-heading">
				
					<span class="method-name">find_full_name</span><span
						class="method-args">(name, mod)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="find-full-name-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 112</span>
112:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_full_name</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">mod</span>)
113:       <span class="ruby-identifier">full_name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">dup</span>
114:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@local_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">full_name</span>)
115:       <span class="ruby-identifier">mod_path</span> = <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">full_name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'::'</span>)[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">2</span>]
116:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">mod_path</span>.<span class="ruby-identifier">nil?</span>
117:         <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">mod_path</span>.<span class="ruby-identifier">empty?</span>
118:           <span class="ruby-identifier">full_name</span> = <span class="ruby-identifier">mod_path</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'::'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">full_name</span>
119:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@local_names</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">full_name</span>)
120:         <span class="ruby-keyword kw">end</span>
121:       <span class="ruby-keyword kw">end</span>
122:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">name</span>
123:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="find-names-method" class="method-detail ">
				<a name="method-i-find_names"></a>

				<div class="method-heading">
				
					<span class="method-name">find_names</span><span
						class="method-args">(mod)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="find-names-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 107</span>
107:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_names</span>(<span class="ruby-identifier">mod</span>)
108:       <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">mod</span>.<span class="ruby-identifier">full_name</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">classes</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">cl</span><span class="ruby-operator">|</span> <span class="ruby-identifier">cl</span>.<span class="ruby-identifier">full_name</span>} <span class="ruby-operator">+</span>
109:         <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">modules</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">find_names</span>(<span class="ruby-identifier">m</span>)}.<span class="ruby-identifier">flatten</span>
110:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="wrap-in-image-map-method" class="method-detail ">
				<a name="method-i-wrap_in_image_map"></a>

				<div class="method-heading">
				
					<span class="method-name">wrap_in_image_map</span><span
						class="method-args">(src, dot)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Extract the client-side image map from dot, and use it to generate the
imagemap proper. Return the whole <map>..<img> combination, suitable for
inclusion on the page
</p>
					

					
					<div class="method-source-code"
						id="wrap-in-image-map-source">
<pre>
     <span class="ruby-comment cmt"># File lib/rdoc/diagram.rb, line 313</span>
313:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wrap_in_image_map</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">dot</span>)
314:       <span class="ruby-identifier">res</span> = <span class="ruby-value str">&quot;&quot;</span>
315:       <span class="ruby-identifier">dot_map</span> = <span class="ruby-node">`dot -Tismap #{src}`</span>
316:       
317:       <span class="ruby-keyword kw">if</span>(<span class="ruby-operator">!</span><span class="ruby-identifier">dot_map</span>.<span class="ruby-identifier">empty?</span>)
318:         <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">%{&lt;map id=&quot;map&quot; name=&quot;map&quot;&gt;\n}</span>
319:         <span class="ruby-identifier">dot_map</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">$/</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">area</span><span class="ruby-operator">|</span>
320:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">area</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^rectangle \((\d+),(\d+)\) \((\d+),(\d+)\) ([\/\w.]+)\s*(.*)/</span>
321:             <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Unexpected output from dot:\n#{area}&quot;</span>
322:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
323:           <span class="ruby-keyword kw">end</span>
324: 
325:           <span class="ruby-identifier">xs</span>, <span class="ruby-identifier">ys</span> = [<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-node">$3</span>.<span class="ruby-identifier">to_i</span>], [<span class="ruby-node">$2</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-node">$4</span>.<span class="ruby-identifier">to_i</span>]
326:           <span class="ruby-identifier">url</span>, <span class="ruby-identifier">area_name</span> = <span class="ruby-node">$5</span>, <span class="ruby-node">$6</span>
327: 
328:           <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span>  <span class="ruby-node">%{  &lt;area shape=&quot;rect&quot; coords=&quot;#{xs.min},#{ys.min},#{xs.max},#{ys.max}&quot; }</span>
329:           <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span>  <span class="ruby-node">%{     href=&quot;#{url}&quot; alt=&quot;#{area_name}&quot; /&gt;\n}</span>
330:         <span class="ruby-keyword kw">end</span>
331:         <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&lt;/map&gt;\n&quot;</span>
332:       <span class="ruby-keyword kw">end</span>
333: 
334:       <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%{&lt;img src=&quot;#{dot}&quot; usemap=&quot;#map&quot; alt=&quot;#{dot}&quot; /&gt;}</span>
335:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>
336:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

